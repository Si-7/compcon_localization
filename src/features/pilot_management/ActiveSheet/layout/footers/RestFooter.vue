<template>
  <v-footer fixed style="padding-bottom: 2px; border-top: 2px solid var(--v-primary-base)">
    <v-row no-gutters :justify="$vuetify.breakpoint.smAndDown ? 'space-around' : ''">
      <v-col cols="auto">
        <v-dialog v-model="rcDialog" :fullscreen="$vuetify.breakpoint.smAndDown" width="80vw">
          <template v-slot:activator="{ on }">
            <v-btn small class="mr-5" color="warning darken-2" v-on="on">СЛЕДУЮЩИЙ БОЙ</v-btn>
          </template>
          <v-card>
            <v-toolbar dense dark flat tile color="warning darken-3 heading h2">
              СЛЕДУЮЩИЙ БОЙ
              <v-spacer />
              <v-btn icon @click="rcDialog = false"><v-icon>mdi-close</v-icon></v-btn>
            </v-toolbar>
            <v-card-text>
              <p class="flavor-text stark--text mt-2 mb-0 mx-6">
                >//[
                <span class="accent--text">COMP/CON</span>
                :
                <span class="stark-text--text">Необходимо подтверждение.</span>
                Продолжить?
              </p>
              <v-row justify="center" class="mt-2">
                <v-col cols="auto">
                  <v-btn
                    x-large
                    tile
                    color="warning darken-3"
                    @click="
                      rcDialog = false
                      pilot.State.StartCombat()
                    "
                  >
                    &nbsp;Реактивировать боевой режим
                  </v-btn>
                </v-col>
              </v-row>
            </v-card-text>
          </v-card>
        </v-dialog>
      </v-col>
      <v-col cols="auto">
        <v-dialog v-model="emDialog" :fullscreen="$vuetify.breakpoint.smAndDown" width="80vw">
          <template v-slot:activator="{ on }">
            <v-btn small class="mr-5" color="error darken-2" v-on="on">ЗАКОНЧИТЬ МИССИЮ</v-btn>
          </template>
          <v-card>
            <v-toolbar dense dark flat tile color="warning darken-3 heading h2">
              ЗАКОНЧИТЬ МИССИЮ
              <v-spacer />
              <v-btn icon @click="emDialog = false"><v-icon>mdi-close</v-icon></v-btn>
            </v-toolbar>
            <v-card-text>
              <div>
                <v-checkbox v-model="saveCheckbox" dense hide-details label="Save Mission Data" />
              </div>
              <p v-show="saveCheckbox" class="flavor-text stark--text mt-2 mb-0 mx-6">
                >//[
                <span class="accent--text">COMP/CON</span>
                :
                <span class="stark-text--text">Необходимо подтверждение</span>
                ] Пилот, продолжение завершает текущую миссию и записывает все данные боевой телеметрии в вашу запись. Это не может быть отменено. Продолжить?
              </p>
              <v-row justify="center" no-gutters class="mt-n2"></v-row>
              <v-alert
                dense
                outlined
                :color="pilot.ActiveMech.Frame.Manufacturer.Color"
                class="mt-4"
              >
                <span v-show="saveCheckbox" class="text--text">
                  Следующие данные миссии будут добавлены в запись боевой телеметрии пилота:
                </span>
                <div class="pl-2 pr-4 flavor-text">
                  <div>
                    ПЕРЕМЕЩЕНИЙ:
                    <b class="stark--text">{{ pilot.State.Stats.moves }}</b>
                  </div>
                  <div>
                    УРОНА НАНЕСЕНО:
                    <b class="stark--text">{{ pilot.State.Stats.damage }}</b>
                  </div>
                  <div>
                    ПРОТИВНИКОВ УНИЧТОЖЕНО:
                    <b class="stark--text">{{ pilot.State.Stats.kills }}</b>
                  </div>
                  <div>
                    УРОНА ПОЛУЧЕНО:
                    <b class="stark--text">{{ pilot.State.Stats.hp_damage }}</b>
                  </div>
                  <div>
                    СТРУКТУРЫ ПОТЕРЯНО:
                    <b class="stark--text">{{ pilot.State.Stats.structure_damage }}</b>
                  </div>
                  <div>
                    НАГРЕВА ПОЛУЧЕНО:
                    <b class="stark--text">{{ pilot.State.Stats.heat_damage }}</b>
                  </div>
                  <div>
                    НАГРУЗОК:
                    <b class="stark--text">{{ pilot.State.Stats.reactor_damage }}</b>
                  </div>
                </div>
              </v-alert>
              <v-row justify="center" class="mt-2">
                <v-col cols="auto">
                  <v-btn
                    x-large
                    tile
                    color="warning darken-3"
                    @click="
                      emDialog = false
                      pilot.State.EndMission(!saveCheckbox)
                    "
                  >
                    &nbsp;Завершить миссию
                  </v-btn>
                </v-col>
              </v-row>
            </v-card-text>
          </v-card>
        </v-dialog>
      </v-col>

      <v-col v-if="$vuetify.breakpoint.mdAndUp">
        <span class="flavor-text">
          >//[
          <span class="accent--text">COMP/CON</span>
          :
          <span class="stark-text--text">Полевые протоколы починки активированы</span>
          ]
        </span>
      </v-col>
    </v-row>
    <!-- <div class="mt-n1">
      <cc-tooltip inline content="Combat Log" delayed>
        <v-btn class="mx-1" small fab elevation="0" color="primary" @click="openMenu(0)">
          <v-icon color="white" size="25">mdi-notebook</v-icon>
        </v-btn>
      </cc-tooltip>

      <cc-tooltip inline content="Other" delayed>
        <v-btn class="mx-1" small fab elevation="0" color="primary" @click="openMenu(1)">
          <v-icon color="white" size="25">mdi-dots-vertical</v-icon>
        </v-btn>
      </cc-tooltip>
    </div> -->
  </v-footer>
</template>

<script lang="ts">
import ActionMenuButton from '../../components/ActionMenuButton.vue'
import activePilot from '@/features/pilot_management/mixins/activePilot'
import vueMixins from '@/util/vueMixins'

export default vueMixins(activePilot).extend({
  name: 'turn-footer',
  components: { ActionMenuButton },
  data: () => ({
    emDialog: false,
    rcDialog: false,
    saveCheckbox: true,
  }),
  methods: {
    openMenu(idx: number) {
      console.log(idx)
    },
  },
})
</script>
